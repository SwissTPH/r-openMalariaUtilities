<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="openMalariaUtilities">
<title>Introduction to openMalariaUtilities • openMalariaUtilities</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to openMalariaUtilities">
<meta property="og:description" content="openMalariaUtilities">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openMalariaUtilities</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">22.08.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/openmalariautilities.html">Introduction to openMalariaUtilities</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SwissTPH/r-openMalariaUtilities/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to openMalariaUtilities</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SwissTPH/r-openMalariaUtilities/blob/HEAD/vignettes/openmalariautilities.Rmd" class="external-link"><code>vignettes/openmalariautilities.Rmd</code></a></small>
      <div class="d-none name"><code>openmalariautilities.Rmd</code></div>
    </div>

    
    
<p>Open Malaria is a powerful tool for simulating and studying the epidemiology of malaria. However, it can also be daunting. This R package is designed to make the use of Open Malaria easier.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>Make sure that <code>SQLite</code> and <code>Open Malaria</code> are both installed and available on the system. Please note: Even though the package should work on Windows, it is developed and tested under Linux.</p>
<p>To install the package, run</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"SwissTPH/r-openMalariaUtilities"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Withing this tutorial, we will create and run example scenarios. Each scenario needs to be defined in a XML file which serves as an input for Open Malaria (OM). OpenMalariaUtilities (OMU) contains many functions which help to generate these input files. In this tutorial we will re-create the example from Open Malaria itself.</p>
</div>
<div class="section level2">
<h2 id="xml-file-generation">XML file generation<a class="anchor" aria-label="anchor" href="#xml-file-generation"></a>
</h2>
<p>A large part of OMU is dedicated at the generation of valid OM XML files. Before we start with the generation of these files, we will explain the folder layout of your projects.</p>
<p>In the folder hierarchy, your working or project directory is the top level. Within this folder, you can have one or more folders which correspond to the names of experiments. The simulations of these experiments are controlled via one or multiple R scripts, placed in the project directory. Please note: Most of the directories can be modified via function arguments, but for the sake of simplicity we using the defaults here.</p>
<pre><code>MyProject
├── experiment_1
├── experiment_2
├── ...
├── script_1.R
├── script_2.R
└── ...</code></pre>
<p>Each of the experiment folders will have a similar layout and content.</p>
<pre><code>MyProject/experiment_1
├── cache/
├── logs/
├── outputs/
├── scenarios/
├── autoRegressionParameters.csv
├── densities.csv
├── base.xml
└── scenario_44.xsd</code></pre>
<p>You do not need to worry about the creation of the folders and files. OMU will create necessary folders and download required files for you.</p>
<p>The <code>cache</code> folder contains R objects which are used by OMU to store reusable information. This will speed up certain operations. Log files are stored in the <code>logs</code> folder (which will contain sub-folders for each step in the process) and OM’s raw output will be <code>outputs</code>. The XML files for each simulation scenario are stored in the <code>scenarios</code> folder.</p>
<div class="section level3">
<h3 id="starting-the-project">Starting the project<a class="anchor" aria-label="anchor" href="#starting-the-project"></a>
</h3>
<p>In your R script, you will probably start with <code><a href="https://swisstph.github.io/r-openMalariaUtilities">library(openMalariaUtilities)</a></code>. Thus, the beginning could look like</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://swisstph.github.io/r-openMalariaUtilities">openMalariaUtilities</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Basic skeleton</span></span>
<span><span class="va">baseList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## Mandatory</span></span>
<span>  expName <span class="op">=</span> <span class="st">"example"</span>,</span>
<span>  <span class="co">## Mandatory</span></span>
<span>  OMVersion <span class="op">=</span> <span class="fl">44L</span>,</span>
<span>  <span class="co">## Optional</span></span>
<span>  <span class="co">## analysisNo = 1L,</span></span>
<span>  <span class="co">## Mandatory</span></span>
<span>  demography <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  monitoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  interventions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  healthSystem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  entomology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="co">## These are optional for OM</span></span>
<span>  <span class="co">## parasiteGenetics = list(),</span></span>
<span>  <span class="co">## pharmacology = list(),</span></span>
<span>  <span class="co">## diagnostics = list(),</span></span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For XML file generation, OMU uses a list as input (here: <code>baseList</code>). This list has a very <a href="https://swisstph.github.io/openmalaria/schema-latest.html" class="external-link">similar structure</a> as the XML file required by OM but is easier to edit from R compared to XML. The above snippet corresponds to the minimal skeleton of this input list. <code>expName</code> is the name of your experiment and <code>OMVersion</code> the version of Open Malaria. Currently, only version 44 is supported. Also note, that the OM version needs to be an integer.</p>
<p>Each of the six nested lists <code>demography</code>, <code>monitoring</code>, <code>interventions</code>, <code>healthSystem</code>, <code>entomology</code> and <code>model</code> need to be filled for OM.</p>
</div>
<div class="section level3">
<h3 id="demography">Demography<a class="anchor" aria-label="anchor" href="#demography"></a>
</h3>
<p>There are two ways to add the data to the <code>demography</code> entry:</p>
<ol style="list-style-type: decimal">
<li>Add it manually, e.g. <code>baseList[["demography"]] &lt;- list(name = "Ifakara",    ...)</code>
</li>
<li>Use the provided <code>defineDemography</code> function</li>
</ol>
<p>We will use the second option in this tutorial. You can find various <code>defineXY</code> functions which are each designed to add a specific entry to the list. However, you always have the option to write parts or change specific entries manually (See also <code>extractList</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  poppercent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">3.474714994</span>, <span class="fl">12.76004028</span>, <span class="fl">14.52151394</span>, <span class="fl">12.75565434</span>, <span class="fl">10.83632374</span>,</span>
<span>    <span class="fl">8.393312454</span>, <span class="fl">7.001421452</span>, <span class="fl">5.800587654</span>, <span class="fl">5.102136612</span>, <span class="fl">4.182561874</span>,</span>
<span>    <span class="fl">3.339409351</span>, <span class="fl">2.986112356</span>, <span class="fl">2.555766582</span>, <span class="fl">2.332763433</span>, <span class="fl">1.77400255</span>,</span>
<span>    <span class="fl">1.008525491</span>, <span class="fl">0.74167341</span>, <span class="fl">0.271863401</span>, <span class="fl">0.161614642</span></span>
<span>  <span class="op">)</span>,</span>
<span>  upperbound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">50</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="fl">65</span>, <span class="fl">70</span>, <span class="fl">75</span>, <span class="fl">80</span>, <span class="fl">85</span>, <span class="fl">90</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">baseList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineDemography.html">defineDemography</a></span><span class="op">(</span></span>
<span>  <span class="va">baseList</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Ifakara"</span>,</span>
<span>  popSize <span class="op">=</span> <span class="fl">4000L</span>,</span>
<span>  maximumAgeYrs <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  lowerbound <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  poppercent <span class="op">=</span> <span class="va">demo_data</span><span class="op">$</span><span class="va">poppercent</span>,</span>
<span>  upperbound <span class="op">=</span> <span class="va">demo_data</span><span class="op">$</span><span class="va">upperbound</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">baseList</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ expName      : chr "example"</span></span>
<span><span class="co">#&gt;  $ OMVersion    : int 44</span></span>
<span><span class="co">#&gt;  $ demography   :List of 4</span></span>
<span><span class="co">#&gt;   ..$ name         : chr "Ifakara"</span></span>
<span><span class="co">#&gt;   ..$ popSize      : int 4000</span></span>
<span><span class="co">#&gt;   ..$ maximumAgeYrs: num 90</span></span>
<span><span class="co">#&gt;   ..$ ageGroup     :List of 20</span></span>
<span><span class="co">#&gt;  $ monitoring   : list()</span></span>
<span><span class="co">#&gt;  $ interventions: list()</span></span>
<span><span class="co">#&gt;  $ healthSystem : list()</span></span>
<span><span class="co">#&gt;  $ entomology   : list()</span></span>
<span><span class="co">#&gt;  $ model        : list()</span></span></code></pre></div>
<p>In the above snippet, we started by creating a data frame which contains the demographic data. This in turn was used as input for <code>defineDemography</code> among other parameters. The function will take care that the information is added at the correct position and also check, that the correct data types are used.</p>
</div>
<div class="section level3">
<h3 id="monitoring">Monitoring<a class="anchor" aria-label="anchor" href="#monitoring"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Roland Goers, Christian Selinger, Emilie Pothin, Munir Winkel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
