<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Collect Open Malaria results into a database"><title>Collect Open Malaria results into a database — collectResults • openMalariaUtilities</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Collect Open Malaria results into a database — collectResults"><meta property="og:description" content="Collect Open Malaria results into a database"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openMalariaUtilities</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">23.02</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/collectResults.html">collectResults</a>
    <a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/openmalariautilities.html">Introduction to openMalariaUtilities</a>
    <a class="dropdown-item" href="../articles/scenarios.html">Multi-Scenario Experiments</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SwissTPH/r-openMalariaUtilities/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Collect Open Malaria results into a database</h1>
      <small class="dont-index">Source: <a href="https://github.com/SwissTPH/r-openMalariaUtilities/blob/HEAD/R/db.R" class="external-link"><code>R/db.R</code></a></small>
      <div class="d-none name"><code>collectResults.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Collect Open Malaria results into a database</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">collectResults</span><span class="op">(</span></span>
<span>  <span class="va">expDir</span>,</span>
<span>  <span class="va">dbName</span>,</span>
<span>  dbDir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resultsName <span class="op">=</span> <span class="st">"results"</span>,</span>
<span>  resultsCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scenario_id"</span>, <span class="st">"survey_date"</span>, <span class="st">"third_dimension"</span>,</span>
<span>    <span class="st">"measure"</span>, <span class="st">"value"</span><span class="op">)</span>, types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"INTEGER"</span>, <span class="st">"TEXT"</span>, <span class="st">""</span>, <span class="st">"TEXT"</span>, <span class="st">"NUMERIC"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  indexOn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"scenario_id"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ncoresDT <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  appendResults <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fileFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fileFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  readFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  readFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggrFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggrFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"verboseOutput"</span>, envir <span class="op">=</span> <span class="va">.pkgenv</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">collect_results</span><span class="op">(</span></span>
<span>  <span class="va">expDir</span>,</span>
<span>  <span class="va">dbName</span>,</span>
<span>  dbDir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resultsName <span class="op">=</span> <span class="st">"results"</span>,</span>
<span>  resultsCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scenario_id"</span>, <span class="st">"survey_date"</span>, <span class="st">"third_dimension"</span>,</span>
<span>    <span class="st">"measure"</span>, <span class="st">"value"</span><span class="op">)</span>, types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"INTEGER"</span>, <span class="st">"TEXT"</span>, <span class="st">""</span>, <span class="st">"TEXT"</span>, <span class="st">"NUMERIC"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  indexOn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"scenario_id"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ncoresDT <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  appendResults <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fileFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fileFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  readFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  readFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggrFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggrFunArgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"verboseOutput"</span>, envir <span class="op">=</span> <span class="va">.pkgenv</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>expDir</dt>
<dd><p>Database connection.</p></dd>


<dt>dbName</dt>
<dd><p>Name of the database file without extension.</p></dd>


<dt>dbDir</dt>
<dd><p>Directory of the database file. Defaults to the root directory.</p></dd>


<dt>replace</dt>
<dd><p>If TRUE, replace an exisiting database with same name as in
dbName. Else, try to append the date to the exisiting database.</p></dd>


<dt>resultsName</dt>
<dd><p>Name of the database table to add the results to.</p></dd>


<dt>resultsCols</dt>
<dd><p>A list containing the column names and the column types
of the results table. For example, list(names = c("scenario_id", ...),
types = c("INTEGER", ...)). The "experiment_id" is added automatically.
Types as available for SQLite.</p></dd>


<dt>indexOn</dt>
<dd><p>Define which index to create. Needs to be a lis of the form
list(c(TABLE, COLUMN), c(TABLE, COLUMN), ...).</p></dd>


<dt>ncores</dt>
<dd><p>Number of CPU cores to use.</p></dd>


<dt>ncoresDT</dt>
<dd><p>Number of data.table threads to use on each parallel
cluster.</p></dd>


<dt>strategy</dt>
<dd><p>Defines how to process the files. "batch" means that all
files are read into a single data frame first, then the aggregation
funciton is applied to that data frame and the result is added to the
database. "serial" means that each individual file is processed with the
aggregation function and added to the database.</p></dd>


<dt>appendResults</dt>
<dd><p>If TRUE, do not add metadata to the database and only
write results.</p></dd>


<dt>fileFun</dt>
<dd><p>A function for filtering the input files. Needs to return a
vector of the scenario XML files without path as in the file column of the
scenario data frame. No default.</p></dd>


<dt>fileFunArgs</dt>
<dd><p>Arguments for fileFun as a (named) list.</p></dd>


<dt>readFun</dt>
<dd><p>A function for reading and processing OpenMalaria output
files. Needs to return as data frame. The first argument needs to be the
file name and it needs to have ... as an argument. Scenario IDs are
available by using scenID as an argument. If NULL, defaults to
readOutputFile and the scenario IDs are added automatically.</p></dd>


<dt>readFunArgs</dt>
<dd><p>Arguments for readFun as a (named) list.</p></dd>


<dt>aggrFun</dt>
<dd><p>A function for aggregating the output of readFun. First
argument needs to be the output data frame of readFun and it needs to
generate a data frame. The data frame should NOT contain an experiment_id
column as this is added automatically. The column names needs to match the
ones defined in resultsCols.</p></dd>


<dt>aggrFunArgs</dt>
<dd><p>Arguments for aggrFun as a (named) list.</p></dd>


<dt>verbose</dt>
<dd><p>Boolean, toggle verbose output.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roland Goers, Christian Selinger, Emilie Pothin, Munir Winkel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

